<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Freevent</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>

</head>
	<body>
		<div id="content"></div>
		<div id="events"></div>


		<script type="text/jsx">
			var EventList = React.createClass({

				getInitialState: function(){
					return { event: [], borough: [] };
				},

				componentDidMount:function(){
					var url ="http://api.nytimes.com/svc/events/v2/listings.json?&filters=free:true&" + this.props.apiKey;
					$.getJSON(url, function(result){

							if(!result || !result.data || !result.data.length){
								return;
							}

							var event = result.data.map(function(p){
								return { event: p.event };
							});

							self.setState({event: event});
					});
				},

				render: function(){
					var self = this;

					var events = this.state.events.map(function(p){
						return <EventList ref={p.event}
					});

					return (
						<div>
							<h1>Events</h1>
							<div className="events">{events}</div>
						</div>
					);
				}
			});

			React.renderComponent(
				<EventList apiKey="bc675c9b17f7d8f5d572be364b116367:9:61020068" />,
				document.getElementById('events')
			)

		</script>
	</body>
</html>